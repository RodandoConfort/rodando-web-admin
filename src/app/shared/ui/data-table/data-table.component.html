<mat-card class="data-table-card">
 <!-- Header con título + botón Acciones -->
  <div class="data-table-header">
    <h3 class="data-table-title">{{ title }}</h3>

    <div class="data-table-actions" *ngIf="actions?.length">
      <button
        mat-stroked-button
        color="primary"
        [matMenuTriggerFor]="actionsMenu"
      >
        <mat-icon>more_vert</mat-icon>
        Acciones
      </button>

      <mat-menu #actionsMenu="matMenu">
        <button
          mat-menu-item
          *ngFor="let action of actions"
          (click)="onActionClick(action)"
          [disabled]="action.disabled"
        >
          <mat-icon *ngIf="action.icon">{{ action.icon }}</mat-icon>
          <span>{{ action.label }}</span>
        </button>
      </mat-menu>
    </div>
  </div>

  <div class="data-table-wrapper">
    <div class="data-table-container">
      <table
        mat-table
        [dataSource]="data"
        class="mat-elevation-z1 data-table"
      >
        <!-- Columna de selección (opcional) -->
        <ng-container *ngIf="enableSelection" matColumnDef="select">
          <th mat-header-cell *matHeaderCellDef class="select-header">
            <mat-checkbox
              color="primary"
              (change)="$event ? toggleAllRows() : null"
              [checked]="selectionHasValue && isAllSelected"
              [indeterminate]="selectionHasValue && !isAllSelected"
              [aria-label]="checkboxLabel()"
            >
            </mat-checkbox>
          </th>

          <td mat-cell *matCellDef="let row" class="select-cell">
            <mat-checkbox
              color="primary"
              (click)="$event.stopPropagation()"
              (change)="$event ? toggleRow(row) : null"
              [checked]="selection.isSelected(row)"
              [aria-label]="checkboxLabel(row)"
            >
            </mat-checkbox>
          </td>
        </ng-container>

        <!-- Columnas dinámicas -->
        <ng-container
          *ngFor="let col of visibleColumns"
          [matColumnDef]="col.id"
        >
          <th
            mat-header-cell
            *matHeaderCellDef
            [class.text-right]="col.align === 'right'"
            [class.text-center]="col.align === 'center'"
          >
            {{ col.header }}
          </th>

          <td
            mat-cell
            *matCellDef="let row"
            [class.text-right]="col.align === 'right'"
            [class.text-center]="col.align === 'center'"
          >
            <ng-container *ngIf="col.field as field; else noField">
              {{ row[field] }}
            </ng-container>
            <ng-template #noField>—</ng-template>
          </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedColumnIds"></tr>
        <tr
          mat-row
          *matRowDef="let row; columns: displayedColumnIds"
          class="data-table-row"
          (click)="onRowClicked(row)"
        ></tr>
      </table>
    </div>

    <!-- Paginador integrado -->
    <mat-paginator
      *ngIf="enablePagination"
      class="data-table-paginator"
      [length]="length"
      [pageIndex]="pageIndex"
      [pageSize]="pageSize"
      [pageSizeOptions]="pageSizeOptions"
      (page)="onPage($event)"
    >
    </mat-paginator>
  </div>
</mat-card>
